(function(e){let t,n=new Set,r=new Map,i=[],a,o=Symbol(),s=Symbol(),c=Symbol(),l=Symbol(),u=Symbol(),d=Symbol();function f(e){let n={[o]:`_`+Math.random()};return r.set(n[o],n),n.run=()=>{t&&(n[s]=t[o],t[c]=t[c]||[],t[c].push(n[o])),t=n,n.last=e(),t=r.get([n[s]])},n.unwatch=function(){n[u]=1,i.push(n[o]),a&&clearTimeout(a),a=setTimeout(()=>{for(let e of i)p(e);i=[],a=null},50)},n.run(),n}function p(e){let t=r.get(e);if(t?.[d]?.(),t?.[c]){for(let e of t[c])p(e);t[s]=null,t[c]=null}if(t?.[l]){for(let n of t[l])n.has(e)&&n.delete(e);t[l]=null}r.delete(e)}function m(e){return h(e,new Map)}function h(e,n){let r=typeof e==`object`&&!Array.isArray(e)?Object.getOwnPropertyDescriptors(e):{};return new Proxy(e,{get(e,i,a){let c;if(r[i]?.get){if(!t)return r[i]?.get?.call(e);c=i,i=`@`+i}if(typeof i==`symbol`||typeof e[i]==`function`)return e[i];if(typeof e[i]==`object`&&e[i]!==null&&!e[i][s]&&(e[i][s]=[e,i],e[i]=h(e[i],n)),t){let s=g(e,i),u=t[o],p=n.get(s);if(p||(p=new Set,n.set(s,p)),p.add(u),t[l]=t[l]||new Set,t[l].add(p),c&&!r[c]._watchers?.has(u)){r[c]._watchers=r[c]._watchers||new Set,r[c]._watchers.add(u);let t=r[c].get.bind(e),n=f(()=>a[i]=t());n[d]=()=>{r[c]?.watchers?.delete(watcherId)}}}return e[i]},set(e,t,r){if(typeof t==`symbol`)return e[t]=r,!0;let i=e[t];return e[t]=r,(r!=i||t===`length`)&&_(e,t,n),!0},deleteProperty(e,t){if(typeof t!=`symbol`){_(e,t,n);let r=g(e,t);n.has(r)&&n.delete(r)}return delete e[t],!0}})}function g(e,t){let n=t,r=e?.[s];for(;r;)n=r[1]+`.`+n,r=r[0][s];return n}function _(e,t,i){let a=g(e,t),o=i.get(a);if(!o)return!0;for(let e of o)n.add(e),n.size==1&&queueMicrotask(()=>{let e;for(let t of n)e=r.get(t),!(!e||e[u])&&(e[s]&&n.has(e[s])||e.run());n.clear()})}let v=new Proxy({},{get(e,t){return function(){return b(),T.call(void 0,t,...arguments)}}}),y=!1;function b(){if(y)return;y=!0;function e(t,n){for(let r of n)r[t]&&r[t](),r.childNodes&&e(t,r.childNodes)}new MutationObserver(t=>{for(let n of t)e(`onmount`,n.addedNodes),e(`onunmount`,n.removedNodes)}).observe(document,{childList:!0,subtree:!0})}let x=Symbol(),S=Symbol(),C=Symbol(),w=Symbol();function T(e,t={},...n){let r=document.createElement(e);if(t)for(let e in t){let n=t[e],i=!1;e.length>5&&e.startsWith(`html-`)&&(i=!0,e=e.substring(5)),typeof n!=`function`||e.length>2&&e.startsWith(`on`)?i?r.setAttribute(e,n):r[e]=n:(r[x]=r[x]||[],r[x].push(()=>{r&&(i?r.setAttribute(e,n()):r[e]=n())}))}let i=r.onmount;r.onmount=()=>{if(!r[C]){if(r[C]=!0,r[x]){r[S]=r[S]||[];for(let e of r[x])r[S].push(f(e))}i?.()}};let a=r.onunmount;return r.onunmount=()=>{if(r[C]){if(r[C]=!1,r[S])for(let e of r[S])e.unwatch();if(r[S]=null,r[w])for(let e of r[w])e();r[w]=null,a?.()}},E(r,n),r}function E(e,t){t=A(t);for(let n of t)Array.isArray(n)?E(e,n):typeof n==`function`?D(e,n):e.appendChild(j(n))}function D(e,t){let n=document.createComment(``);e.appendChild(n);let r=[],i=new Map,a=e.moveBefore||e.insertBefore;e[w]=e[w]||[],e[w].push(()=>{r=null,i=null,n=null}),e[x]=e[x]||[],e[x].push(()=>{if(!e)return;let o=A(t()),s=o.length,c=new Map;if(!r?.length){let t=document.createDocumentFragment();for(let e=0;e<s;e++){o[e]=j(o[e]),t.appendChild(o[e]);let n=o[e].rid;n!==void 0&&(c.has(n)?console.warn(`Duplicated rid:`,n,o[e]):c.set(n,e))}e.insertBefore(t,n),t=null,r=o,i=c;return}let l=[],u=[],d=new Set,f=[];for(let e=0;e<s;e++){o[e]=j(o[e]);let t=o[e].rid;if(t!==void 0){c.has(t)?console.warn(`Duplicated rid:`,t,o[e]):c.set(t,e);let n=i.get(t);if(n>=0){d.add(r[n]),o[e]=r[n],f.push(n);continue}}u.push({child:o[e],prev:o[e-1]})}let p=O(f);f.length!=p.length&&f.forEach((e,t)=>{p.has(e)||l.push({child:r[e],currentPos:e,targetPos:t})});for(let t of l){let n=r[t.targetPos];k(r,t.currentPos,t.targetPos),a.call(e,t.child,n)}for(let e of u)e.prev?e.prev.after(e.child):(r[0]||n).before(e.child);for(let e=0;e<r.length;e++)d.has(r[e])||r[e].remove?.();r=o,i=c,o=null,c=null,d=null,l=null,u=null})}function O(e){let t=[],n=[];for(let r=0;r<e.length;r++){let i=e[r],a=0,o=0,s=t.length;for(;a<s;)o=Math.floor((a+s)/2),e[t[o]]>=i?s=o:a=o+1;a>0&&(n[r]=t[a-1]),t[a]=r}let r=new Set,i=t[t.length-1];for(;i!==void 0;)r.add(e[i]),i=n[i];return r}function k(e,t,n){if(t==n)return e;let r=t>n?-1:1,i=e[t];for(let i=t;i!=n;i+=r)e[i]=e[i+r];e[n]=i}function A(e){return e==null?[]:Array.isArray(e)?e:[e]}function j(e){if(typeof e==`string`||typeof e==`number`){let t=document.createTextNode(e);return t.rid=e,t}return e}function M(e,t={fallbackPath:`#/`,transition:!0}){let n=P(e),r,i=()=>{let e=N(n,window.location.hash||t.fallbackPath)||N(n,t.fallbackPath);if(!e){console.warn(`no route found`);return}let i=async()=>{try{await r?.(),r=await e.handler(e)}catch(e){console.warn(`Route navigation failed:`,e)}};t.transition&&document.startViewTransition?document.startViewTransition(i):i()};window.addEventListener(`hashchange`,i),i()}function N(e,t){for(let n of e){let e=t.match(n.regex);if(!e)continue;let r={},i=t.split(`?`)?.[1];if(i){let e=new URLSearchParams(i);for(let[t,n]of e.entries())Array.isArray(r[t])||(r[t]=r[t]?[r[t]]:[]),r[t].push(n)}return Object.assign({path:t,query:r,params:e.groups||{}},n)}}function P(e){let t=[];for(let n in e){let r=n.split(`/`);for(let e in r)r[e].length>2&&r[e].startsWith(`{`)&&r[e].endsWith(`}`)?r[e]=`(?<`+r[e].substring(1,r[e].length-1)+`>\\w+)`:r[e]=RegExp.escape(r[e]);t.push({regex:RegExp(`^`+r.join(`\\/`)+`(?:[?#].*)?$`),pattern:n,handler:e[n]})}return t}e.router=M,e.store=m,e.t=v,e.watch=f})(this.window=this.window||{});
//# sourceMappingURL=shablon.iife.js.map